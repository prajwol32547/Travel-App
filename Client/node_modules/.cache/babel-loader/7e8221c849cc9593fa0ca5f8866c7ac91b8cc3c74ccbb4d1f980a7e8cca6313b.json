{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// AxiosReq.js\n\nimport Axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { refresh } from \"./Refresh\";\nconst intercept = Axios.create({\n  withCredentials: true,\n  headers: {\n    \"Content-Type\": \"application/json\"\n  }\n});\n\n// Move the useNavigate hook call inside a functional component or a custom hook\nconst getRequestInterceptor = () => {\n  _s();\n  const navigate = useNavigate();\n  return intercept.interceptors.request.use(function (config) {\n    const authToken = localStorage.getItem(\"jwtToken\");\n    intercept.headers.Authorization = `Bearer ${authToken}`;\n    if (!authToken) {\n      navigate(\"/login\");\n    }\n    return config;\n  });\n};\n_s(getRequestInterceptor, \"CzcTeTziyjMsSrAVmHuCCb6+Bfg=\", false, function () {\n  return [useNavigate];\n});\nconst responseIntercept = _s2(intercept.interceptors.response.use(response => response, _s2(async error => {\n  var _error$response;\n  _s2();\n  const prevRequest = error === null || error === void 0 ? void 0 : error.config;\n  if ((error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 403 && !(prevRequest !== null && prevRequest !== void 0 && prevRequest.sent)) {\n    try {\n      await refresh();\n      return Axios(prevRequest);\n    } catch (refreshError) {\n      console.error(\"Refresh failed\", refreshError);\n      useNavigate()(\"/login\");\n    }\n  }\n  return Promise.reject(error);\n}, \"7z+bV9xHBQ1A1bt6m/1oQLk0tZA=\", false, function () {\n  return [useNavigate];\n})), \"7z+bV9xHBQ1A1bt6m/1oQLk0tZA=\", false, function () {\n  return [useNavigate];\n});\n\n// Use the getRequestInterceptor function to get the interceptor\ngetRequestInterceptor();\n\n// Other parts of your code...\nexport const postRequest = async (api, data) => {\n  try {\n    const res = await intercept.post(api, data);\n    return res.data;\n  } catch (error) {\n    console.error(\"Post request failed\", error);\n    throw error;\n  }\n};\nexport const getRequest = async api => {\n  try {\n    const res = await intercept.get(api);\n    return res.data;\n  } catch (error) {\n    console.error(\"Get request failed\", error);\n    throw error;\n  }\n};","map":{"version":3,"names":["Axios","useNavigate","refresh","intercept","create","withCredentials","headers","getRequestInterceptor","navigate","interceptors","request","use","config","authToken","localStorage","getItem","Authorization","responseIntercept","response","error","prevRequest","status","sent","refreshError","console","Promise","reject","postRequest","api","data","res","post","getRequest","get"],"sources":["/home/prajwol/Travel-App/travelapp/Client/src/Atom/AxiosReq.js"],"sourcesContent":["// AxiosReq.js\n\nimport Axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { refresh } from \"./Refresh\";\n\nconst intercept = Axios.create({\n\twithCredentials: true,\n\theaders: { \"Content-Type\": \"application/json\" },\n});\n\n// Move the useNavigate hook call inside a functional component or a custom hook\nconst getRequestInterceptor = () => {\n\tconst navigate = useNavigate();\n\n\treturn intercept.interceptors.request.use(function (config) {\n\t\tconst authToken = localStorage.getItem(\"jwtToken\");\n\t\tintercept.headers.Authorization = `Bearer ${authToken}`;\n\n\t\tif (!authToken) {\n\t\t\tnavigate(\"/login\");\n\t\t}\n\n\t\treturn config;\n\t});\n};\n\nconst responseIntercept = intercept.interceptors.response.use(\n\t(response) => response,\n\tasync (error) => {\n\t\tconst prevRequest = error?.config;\n\n\t\tif (error?.response?.status === 403 && !prevRequest?.sent) {\n\t\t\ttry {\n\t\t\t\tawait refresh();\n\t\t\t\treturn Axios(prevRequest);\n\t\t\t} catch (refreshError) {\n\t\t\t\tconsole.error(\"Refresh failed\", refreshError);\n\t\t\t\tuseNavigate()(\"/login\");\n\t\t\t}\n\t\t}\n\n\t\treturn Promise.reject(error);\n\t}\n);\n\n// Use the getRequestInterceptor function to get the interceptor\ngetRequestInterceptor();\n\n// Other parts of your code...\nexport const postRequest = async (api, data) => {\n\ttry {\n\t\tconst res = await intercept.post(api, data);\n\t\treturn res.data;\n\t} catch (error) {\n\t\tconsole.error(\"Post request failed\", error);\n\t\tthrow error;\n\t}\n};\n\nexport const getRequest = async (api) => {\n\ttry {\n\t\tconst res = await intercept.get(api);\n\t\treturn res.data;\n\t} catch (error) {\n\t\tconsole.error(\"Get request failed\", error);\n\t\tthrow error;\n\t}\n};\n"],"mappings":";;AAAA;;AAEA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,OAAO,QAAQ,WAAW;AAEnC,MAAMC,SAAS,GAAGH,KAAK,CAACI,MAAM,CAAC;EAC9BC,eAAe,EAAE,IAAI;EACrBC,OAAO,EAAE;IAAE,cAAc,EAAE;EAAmB;AAC/C,CAAC,CAAC;;AAEF;AACA,MAAMC,qBAAqB,GAAG,MAAM;EAAA;EACnC,MAAMC,QAAQ,GAAGP,WAAW,EAAE;EAE9B,OAAOE,SAAS,CAACM,YAAY,CAACC,OAAO,CAACC,GAAG,CAAC,UAAUC,MAAM,EAAE;IAC3D,MAAMC,SAAS,GAAGC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC;IAClDZ,SAAS,CAACG,OAAO,CAACU,aAAa,GAAI,UAASH,SAAU,EAAC;IAEvD,IAAI,CAACA,SAAS,EAAE;MACfL,QAAQ,CAAC,QAAQ,CAAC;IACnB;IAEA,OAAOI,MAAM;EACd,CAAC,CAAC;AACH,CAAC;AAAC,GAbIL,qBAAqB;EAAA,QACTN,WAAW;AAAA;AAc7B,MAAMgB,iBAAiB,OAAGd,SAAS,CAACM,YAAY,CAACS,QAAQ,CAACP,GAAG,CAC3DO,QAAQ,IAAKA,QAAQ,MACtB,MAAOC,KAAK,IAAK;EAAA;EAAA;EAChB,MAAMC,WAAW,GAAGD,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEP,MAAM;EAEjC,IAAI,CAAAO,KAAK,aAALA,KAAK,0CAALA,KAAK,CAAED,QAAQ,oDAAf,gBAAiBG,MAAM,MAAK,GAAG,IAAI,EAACD,WAAW,aAAXA,WAAW,eAAXA,WAAW,CAAEE,IAAI,GAAE;IAC1D,IAAI;MACH,MAAMpB,OAAO,EAAE;MACf,OAAOF,KAAK,CAACoB,WAAW,CAAC;IAC1B,CAAC,CAAC,OAAOG,YAAY,EAAE;MACtBC,OAAO,CAACL,KAAK,CAAC,gBAAgB,EAAEI,YAAY,CAAC;MAC7CtB,WAAW,EAAE,CAAC,QAAQ,CAAC;IACxB;EACD;EAEA,OAAOwB,OAAO,CAACC,MAAM,CAACP,KAAK,CAAC;AAC7B,CAAC;EAAA,QALElB,WAAW;AAAA,GAMd;EAAA,QANGA,WAAW;AAAA,EAMd;;AAED;AACAM,qBAAqB,EAAE;;AAEvB;AACA,OAAO,MAAMoB,WAAW,GAAG,OAAOC,GAAG,EAAEC,IAAI,KAAK;EAC/C,IAAI;IACH,MAAMC,GAAG,GAAG,MAAM3B,SAAS,CAAC4B,IAAI,CAACH,GAAG,EAAEC,IAAI,CAAC;IAC3C,OAAOC,GAAG,CAACD,IAAI;EAChB,CAAC,CAAC,OAAOV,KAAK,EAAE;IACfK,OAAO,CAACL,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;IAC3C,MAAMA,KAAK;EACZ;AACD,CAAC;AAED,OAAO,MAAMa,UAAU,GAAG,MAAOJ,GAAG,IAAK;EACxC,IAAI;IACH,MAAME,GAAG,GAAG,MAAM3B,SAAS,CAAC8B,GAAG,CAACL,GAAG,CAAC;IACpC,OAAOE,GAAG,CAACD,IAAI;EAChB,CAAC,CAAC,OAAOV,KAAK,EAAE;IACfK,OAAO,CAACL,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAAC;IAC1C,MAAMA,KAAK;EACZ;AACD,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}